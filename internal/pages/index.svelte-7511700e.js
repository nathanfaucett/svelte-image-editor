import{N as Mt,O as nt,P as F,S as st,i as it,s as ot,e as w,k as S,c as D,a as E,d as m,m as k,b as _,Q as lt,R as St,g as $,I as h,T as kt,U as Bt,V as Ct,W as at,M as rt,X as Ot,Y as ct,Z as zt,v as At,_ as O,$ as tt,a0 as et,a1 as Lt,a2 as ut,E as qt,a3 as G,a4 as Ft,w as Nt,t as Pt,x as Tt,h as Ut,y as Wt,a5 as jt,q as Ht,o as Xt,B as Yt,a6 as Zt}from"../chunks/vendor-2deebe90.js";function Qt(t,i,e,g){const s=e[0],o=e[1],a=Math.cos(g),d=Math.sin(g);return t[0]=a*s,t[1]=d*s,t[2]=-d*o,t[3]=a*o,t[4]=i[0],t[5]=i[1],t}function ft(t,i){const e=i[1]<t[1]?-1:1;return Math.acos(Mt(t,i)/(nt(t)*nt(i)))*e}function Jt(t){let i,e,g,s,o,a,d,I,r,b,v,l,c,p,V,B,M,C,R,L,z,N,j,A,U;return{c(){i=w("div"),e=w("canvas"),g=S(),s=w("div"),o=w("div"),a=S(),d=w("div"),I=S(),r=w("div"),b=S(),v=w("div"),l=S(),c=w("div"),p=S(),V=w("div"),B=S(),M=w("div"),C=S(),R=w("div"),L=S(),z=w("div"),this.h()},l(u){i=D(u,"DIV",{class:!0});var y=E(i);e=D(y,"CANVAS",{width:!0,height:!0,class:!0}),E(e).forEach(m),g=k(y),s=D(y,"DIV",{class:!0,style:!0});var f=E(s);o=D(f,"DIV",{class:!0}),E(o).forEach(m),a=k(f),d=D(f,"DIV",{class:!0}),E(d).forEach(m),I=k(f),r=D(f,"DIV",{class:!0}),E(r).forEach(m),b=k(f),v=D(f,"DIV",{class:!0}),E(v).forEach(m),l=k(f),c=D(f,"DIV",{class:!0}),E(c).forEach(m),p=k(f),V=D(f,"DIV",{class:!0}),E(V).forEach(m),B=k(f),M=D(f,"DIV",{class:!0}),E(M).forEach(m),C=k(f),R=D(f,"DIV",{class:!0}),E(R).forEach(m),L=k(f),z=D(f,"DIV",{class:!0}),E(z).forEach(m),f.forEach(m),y.forEach(m),this.h()},h(){_(e,"width",t[2]),_(e,"height",t[3]),_(e,"class","svelte-ycy9gn"),_(o,"class","move svelte-ycy9gn"),_(d,"class","top svelte-ycy9gn"),_(r,"class","bottom svelte-ycy9gn"),_(v,"class","left svelte-ycy9gn"),_(c,"class","right svelte-ycy9gn"),_(V,"class","top-left svelte-ycy9gn"),_(M,"class","top-right svelte-ycy9gn"),_(R,"class","bottom-left svelte-ycy9gn"),_(z,"class","bottom-right svelte-ycy9gn"),_(s,"class","bounding-box svelte-ycy9gn"),_(s,"style",N=`left:${t[6][0]}px;top:${t[6][1]}px;width:${t[4]}px;height:${t[5]}px;transform:matrix(${t[0][0]},${t[0][1]},${t[0][2]},${t[0][3]},${t[0][4]},${t[0][5]})`),lt(s,"inactive",!t[7]),_(i,"class","container svelte-ycy9gn"),St(()=>t[39].call(i))},m(u,y){$(u,i,y),h(i,e),t[29](e),h(i,g),h(i,s),h(s,o),t[30](o),h(s,a),h(s,d),t[31](d),h(s,I),h(s,r),t[32](r),h(s,b),h(s,v),t[33](v),h(s,l),h(s,c),t[34](c),h(s,p),h(s,V),t[35](V),h(s,B),h(s,M),t[36](M),h(s,C),h(s,R),t[37](R),h(s,L),h(s,z),t[38](z),j=kt(i,t[39].bind(i)),A||(U=[Bt(Ct.call(null,s,t[18])),at(i,"click",t[17])],A=!0)},p(u,y){y[0]&4&&_(e,"width",u[2]),y[0]&8&&_(e,"height",u[3]),y[0]&113&&N!==(N=`left:${u[6][0]}px;top:${u[6][1]}px;width:${u[4]}px;height:${u[5]}px;transform:matrix(${u[0][0]},${u[0][1]},${u[0][2]},${u[0][3]},${u[0][4]},${u[0][5]})`)&&_(s,"style",N),y[0]&128&&lt(s,"inactive",!u[7])},i:rt,o:rt,d(u){u&&m(i),t[29](null),t[30](null),t[31](null),t[32](null),t[33](null),t[34](null),t[35](null),t[36](null),t[37](null),t[38](null),j(),A=!1,Ot(U)}}}const Kt=F(),dt=F(),xt=F();function $t(t,i,e,g,s,o,a){t.save(),t.clearRect(0,0,i,e),t.translate(i*.5,e*.5),t.transform(a[0],a[1],a[2],a[3],a[4],a[5]),t.drawImage(g,-s*.5,-o*.5,s,o),t.restore()}function te(t,i,e){let g,{src:s}=i,{position:o=ct(0,0)}=i,{scale:a=ct(1,1)}=i,{rotation:d=0}=i,{transform:I=zt()}=i,{image:r=typeof Image=="undefined"?null:new Image}=i,{canvas:b=void 0}=i,{ctx:v=void 0}=i,l,c,p,V,B=F(),M,C=F(),R=F(),L=!1;function z(){e(7,L=!0)}function N(){e(7,L=!1)}function j(n){e(19,o=et(o,o,n.delta))}function A(n,W){return function(q){const T=tt(dt,W*q.delta[n]/B[n],W*q.delta[n]/B[n]);e(20,a=et(a,a,T))}}let U=F(),u=0;function y(n){return function(P){P.first&&(Lt(U,P.xy),u=d);const q=ut(dt,R,U),T=ut(xt,R,P.xy);n===1?e(21,d=u+ft(q,T)):e(21,d=u+ft(T,q))}}let f,H,X,Y,Z,Q,J,K,x;At(()=>{const n=new O(f,j),W=new O(H,A(1,-1)),P=new O(X,A(1,1)),q=new O(Y,A(0,-1)),T=new O(Z,A(0,1)),It=new O(Q,y(1)),Vt=new O(J,y(-1)),Rt=new O(K,y(1)),Gt=new O(x,y(-1));return()=>{n.destroy(),W.destroy(),P.destroy(),q.destroy(),T.destroy(),It.destroy(),Vt.destroy(),Rt.destroy(),Gt.destroy()}});function ht(n){G[n?"unshift":"push"](()=>{b=n,e(1,b)})}function gt(n){G[n?"unshift":"push"](()=>{f=n,e(8,f)})}function _t(n){G[n?"unshift":"push"](()=>{H=n,e(9,H)})}function mt(n){G[n?"unshift":"push"](()=>{X=n,e(10,X)})}function yt(n){G[n?"unshift":"push"](()=>{Y=n,e(11,Y)})}function bt(n){G[n?"unshift":"push"](()=>{Z=n,e(12,Z)})}function vt(n){G[n?"unshift":"push"](()=>{Q=n,e(13,Q)})}function pt(n){G[n?"unshift":"push"](()=>{J=n,e(14,J)})}function wt(n){G[n?"unshift":"push"](()=>{K=n,e(15,K)})}function Dt(n){G[n?"unshift":"push"](()=>{x=n,e(16,x)})}function Et(){l=this.clientWidth,c=this.clientHeight,e(2,l),e(3,c)}return t.$$set=n=>{"src"in n&&e(24,s=n.src),"position"in n&&e(19,o=n.position),"scale"in n&&e(20,a=n.scale),"rotation"in n&&e(21,d=n.rotation),"transform"in n&&e(0,I=n.transform),"image"in n&&e(22,r=n.image),"canvas"in n&&e(1,b=n.canvas),"ctx"in n&&e(23,v=n.ctx)},t.$$.update=()=>{if(t.$$.dirty[0]&2&&e(23,v=b==null?void 0:b.getContext("2d")),t.$$.dirty[0]&88080396&&r&&M!==s&&(e(22,r.crossOrigin="anonymous",r),e(22,r.onload=()=>{const n=Math.min(l/r.width,c/r.height);e(4,p=r.width*n),e(5,V=r.height*n)},r),e(22,r.src=s,r),e(26,M=s)),t.$$.dirty[0]&33554480&&e(25,B=tt(B,p,V)),t.$$.dirty[0]&60&&(e(6,C[0]=l*.5-p*.5,C),e(6,C[1]=c*.5-V*.5,C)),t.$$.dirty[0]&3670017&&e(0,I=Qt(I,o,a,d)),t.$$.dirty[0]&134742030&&b){const n=b.getBoundingClientRect();e(27,R=et(R,tt(Kt,n.left+l*.5,n.top+c*.5),o))}t.$$.dirty[0]&12582973&&e(28,g=()=>{v&&$t(v,l,c,r,p,V,I)}),t.$$.dirty[0]&268435456&&qt().then(g)},[I,b,l,c,p,V,C,L,f,H,X,Y,Z,Q,J,K,x,z,N,o,a,d,r,v,s,B,M,R,g,ht,gt,_t,mt,yt,bt,vt,pt,wt,Dt,Et]}class ee extends st{constructor(i){super();it(this,i,te,Jt,ot,{src:24,position:19,scale:20,rotation:21,transform:0,image:22,canvas:1,ctx:23},null,[-1,-1])}}function ne(t){let i,e,g,s,o,a,d,I,r;function b(l){t[2](l)}let v={src:"https://images.unsplash.com/photo-1579353977828-2a4eab540b9a?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8c2FtcGxlfGVufDB8fDB8fA%3D%3D&w=1000&q=80"};return t[0]!==void 0&&(v.canvas=t[0]),e=new ee({props:v}),G.push(()=>Ft(e,"canvas",b)),{c(){i=w("div"),Nt(e.$$.fragment),s=S(),o=w("button"),a=Pt("Download"),this.h()},l(l){i=D(l,"DIV",{});var c=E(i);Tt(e.$$.fragment,c),c.forEach(m),s=k(l),o=D(l,"BUTTON",{class:!0});var p=E(o);a=Ut(p,"Download"),p.forEach(m),this.h()},h(){_(o,"class","svelte-1kxn0xq")},m(l,c){$(l,i,c),Wt(e,i,null),$(l,s,c),$(l,o,c),h(o,a),d=!0,I||(r=at(o,"click",function(){Zt(t[1])&&t[1].apply(this,arguments)}),I=!0)},p(l,[c]){t=l;const p={};!g&&c&1&&(g=!0,p.canvas=t[0],jt(()=>g=!1)),e.$set(p)},i(l){d||(Ht(e.$$.fragment,l),d=!0)},o(l){Xt(e.$$.fragment,l),d=!1},d(l){l&&m(i),Yt(e),l&&m(s),l&&m(o),I=!1,r()}}}function se(t,i,e){let g,s;function o(a){s=a,e(0,s)}return t.$$.update=()=>{t.$$.dirty&1&&e(1,g=()=>window.open(s.toDataURL("image/png").replace("image/png","image/octet-stream")))},[s,g,o]}class oe extends st{constructor(i){super();it(this,i,se,ne,ot,{})}}export{oe as default};
