import{N as Mt,O as st,P as F,S as nt,i as it,s as ot,e as w,k as S,c as D,a as E,d as m,m as k,b as _,Q as lt,R as St,g as $,I as h,T as kt,U as Bt,V as Ct,W as rt,M as at,X as Ot,Y as ct,Z as zt,v as At,_ as O,$ as tt,a0 as et,a1 as Lt,a2 as ut,E as qt,a3 as G,a4 as Ft,w as Nt,t as Pt,x as Tt,h as Ut,y as Wt,a5 as jt,q as Ht,o as Xt,B as Yt,a6 as Zt}from"../chunks/vendor-2deebe90.js";function Qt(t,i,e,g){const n=e[0],o=e[1],r=Math.cos(g),d=Math.sin(g);return t[0]=r*n,t[1]=d*n,t[2]=-d*o,t[3]=r*o,t[4]=i[0],t[5]=i[1],t}function ft(t,i){const e=i[1]<t[1]?-1:1;return Math.acos(Mt(t,i)/(st(t)*st(i)))*e}function Jt(t){let i,e,g,n,o,r,d,I,a,b,v,l,c,y,V,B,M,C,R,L,z,N,j,A,U;return{c(){i=w("div"),e=w("canvas"),g=S(),n=w("div"),o=w("div"),r=S(),d=w("div"),I=S(),a=w("div"),b=S(),v=w("div"),l=S(),c=w("div"),y=S(),V=w("div"),B=S(),M=w("div"),C=S(),R=w("div"),L=S(),z=w("div"),this.h()},l(u){i=D(u,"DIV",{class:!0});var p=E(i);e=D(p,"CANVAS",{width:!0,height:!0,class:!0}),E(e).forEach(m),g=k(p),n=D(p,"DIV",{class:!0,style:!0});var f=E(n);o=D(f,"DIV",{class:!0}),E(o).forEach(m),r=k(f),d=D(f,"DIV",{class:!0}),E(d).forEach(m),I=k(f),a=D(f,"DIV",{class:!0}),E(a).forEach(m),b=k(f),v=D(f,"DIV",{class:!0}),E(v).forEach(m),l=k(f),c=D(f,"DIV",{class:!0}),E(c).forEach(m),y=k(f),V=D(f,"DIV",{class:!0}),E(V).forEach(m),B=k(f),M=D(f,"DIV",{class:!0}),E(M).forEach(m),C=k(f),R=D(f,"DIV",{class:!0}),E(R).forEach(m),L=k(f),z=D(f,"DIV",{class:!0}),E(z).forEach(m),f.forEach(m),p.forEach(m),this.h()},h(){_(e,"width",t[2]),_(e,"height",t[3]),_(e,"class","svelte-nl3rsp"),_(o,"class","move svelte-nl3rsp"),_(d,"class","top svelte-nl3rsp"),_(a,"class","bottom svelte-nl3rsp"),_(v,"class","left svelte-nl3rsp"),_(c,"class","right svelte-nl3rsp"),_(V,"class","top-left svelte-nl3rsp"),_(M,"class","top-right svelte-nl3rsp"),_(R,"class","bottom-left svelte-nl3rsp"),_(z,"class","bottom-right svelte-nl3rsp"),_(n,"class","bounding-box svelte-nl3rsp"),_(n,"style",N=`left:${t[6][0]}px;top:${t[6][1]}px;width:${t[4]}px;height:${t[5]}px;transform:matrix(${t[0][0]},${t[0][1]},${t[0][2]},${t[0][3]},${t[0][4]},${t[0][5]})`),lt(n,"inactive",!t[7]),_(i,"class","container svelte-nl3rsp"),St(()=>t[39].call(i))},m(u,p){$(u,i,p),h(i,e),t[29](e),h(i,g),h(i,n),h(n,o),t[30](o),h(n,r),h(n,d),t[31](d),h(n,I),h(n,a),t[32](a),h(n,b),h(n,v),t[33](v),h(n,l),h(n,c),t[34](c),h(n,y),h(n,V),t[35](V),h(n,B),h(n,M),t[36](M),h(n,C),h(n,R),t[37](R),h(n,L),h(n,z),t[38](z),j=kt(i,t[39].bind(i)),A||(U=[Bt(Ct.call(null,n,t[18])),rt(i,"click",t[17])],A=!0)},p(u,p){p[0]&4&&_(e,"width",u[2]),p[0]&8&&_(e,"height",u[3]),p[0]&113&&N!==(N=`left:${u[6][0]}px;top:${u[6][1]}px;width:${u[4]}px;height:${u[5]}px;transform:matrix(${u[0][0]},${u[0][1]},${u[0][2]},${u[0][3]},${u[0][4]},${u[0][5]})`)&&_(n,"style",N),p[0]&128&&lt(n,"inactive",!u[7])},i:at,o:at,d(u){u&&m(i),t[29](null),t[30](null),t[31](null),t[32](null),t[33](null),t[34](null),t[35](null),t[36](null),t[37](null),t[38](null),j(),A=!1,Ot(U)}}}const Kt=F(),dt=F(),xt=F();function $t(t,i,e,g,n,o,r){t.save(),t.clearRect(0,0,i,e),t.translate(i*.5,e*.5),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),t.drawImage(g,-n*.5,-o*.5,n,o),t.restore()}function te(t,i,e){let g,{src:n}=i,{position:o=ct(0,0)}=i,{scale:r=ct(1,1)}=i,{rotation:d=0}=i,{transform:I=zt()}=i,{image:a=typeof Image=="undefined"?null:new Image}=i,{canvas:b=void 0}=i,{ctx:v=void 0}=i,l,c,y,V,B=F(),M,C=F(),R=F(),L=!1;function z(){e(7,L=!0)}function N(){e(7,L=!1)}function j(s){e(19,o=et(o,o,s.delta))}function A(s,W){return function(q){const T=tt(dt,W*q.delta[s]/B[s],W*q.delta[s]/B[s]);e(20,r=et(r,r,T))}}let U=F(),u=0;function p(s){return function(P){P.first&&(Lt(U,P.xy),u=d);const q=ut(dt,R,U),T=ut(xt,R,P.xy);s===1?e(21,d=u+ft(q,T)):e(21,d=u+ft(T,q))}}let f,H,X,Y,Z,Q,J,K,x;At(()=>{const s=new O(f,j),W=new O(H,A(1,-1)),P=new O(X,A(1,1)),q=new O(Y,A(0,-1)),T=new O(Z,A(0,1)),It=new O(Q,p(1)),Vt=new O(J,p(-1)),Rt=new O(K,p(1)),Gt=new O(x,p(-1));return()=>{s.destroy(),W.destroy(),P.destroy(),q.destroy(),T.destroy(),It.destroy(),Vt.destroy(),Rt.destroy(),Gt.destroy()}});function ht(s){G[s?"unshift":"push"](()=>{b=s,e(1,b)})}function gt(s){G[s?"unshift":"push"](()=>{f=s,e(8,f)})}function _t(s){G[s?"unshift":"push"](()=>{H=s,e(9,H)})}function mt(s){G[s?"unshift":"push"](()=>{X=s,e(10,X)})}function pt(s){G[s?"unshift":"push"](()=>{Y=s,e(11,Y)})}function bt(s){G[s?"unshift":"push"](()=>{Z=s,e(12,Z)})}function vt(s){G[s?"unshift":"push"](()=>{Q=s,e(13,Q)})}function yt(s){G[s?"unshift":"push"](()=>{J=s,e(14,J)})}function wt(s){G[s?"unshift":"push"](()=>{K=s,e(15,K)})}function Dt(s){G[s?"unshift":"push"](()=>{x=s,e(16,x)})}function Et(){l=this.clientWidth,c=this.clientHeight,e(2,l),e(3,c)}return t.$$set=s=>{"src"in s&&e(24,n=s.src),"position"in s&&e(19,o=s.position),"scale"in s&&e(20,r=s.scale),"rotation"in s&&e(21,d=s.rotation),"transform"in s&&e(0,I=s.transform),"image"in s&&e(22,a=s.image),"canvas"in s&&e(1,b=s.canvas),"ctx"in s&&e(23,v=s.ctx)},t.$$.update=()=>{if(t.$$.dirty[0]&2&&e(23,v=b==null?void 0:b.getContext("2d")),t.$$.dirty[0]&88080396&&a&&M!==n&&(e(22,a.crossOrigin="anonymous",a),e(22,a.onload=()=>{const s=Math.min(l/a.width,c/a.height);e(4,y=a.width*s),e(5,V=a.height*s)},a),e(22,a.src=n,a),e(26,M=n)),t.$$.dirty[0]&33554480&&e(25,B=tt(B,y,V)),t.$$.dirty[0]&60&&(e(6,C[0]=l*.5-y*.5,C),e(6,C[1]=c*.5-V*.5,C)),t.$$.dirty[0]&3670017&&e(0,I=Qt(I,o,r,d)),t.$$.dirty[0]&134742030&&b){const s=b.getBoundingClientRect();e(27,R=et(R,tt(Kt,s.left+l*.5,s.top+c*.5),o))}t.$$.dirty[0]&12582973&&e(28,g=()=>{v&&$t(v,l,c,a,y,V,I)}),t.$$.dirty[0]&268435456&&qt().then(g)},[I,b,l,c,y,V,C,L,f,H,X,Y,Z,Q,J,K,x,z,N,o,r,d,a,v,n,B,M,R,g,ht,gt,_t,mt,pt,bt,vt,yt,wt,Dt,Et]}class ee extends nt{constructor(i){super();it(this,i,te,Jt,ot,{src:24,position:19,scale:20,rotation:21,transform:0,image:22,canvas:1,ctx:23},null,[-1,-1])}}function se(t){let i,e,g,n,o,r,d,I,a;function b(l){t[2](l)}let v={src:"https://images.unsplash.com/photo-1579353977828-2a4eab540b9a?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8c2FtcGxlfGVufDB8fDB8fA%3D%3D&w=1000&q=80"};return t[0]!==void 0&&(v.canvas=t[0]),e=new ee({props:v}),G.push(()=>Ft(e,"canvas",b)),{c(){i=w("div"),Nt(e.$$.fragment),n=S(),o=w("button"),r=Pt("Download"),this.h()},l(l){i=D(l,"DIV",{});var c=E(i);Tt(e.$$.fragment,c),c.forEach(m),n=k(l),o=D(l,"BUTTON",{class:!0});var y=E(o);r=Ut(y,"Download"),y.forEach(m),this.h()},h(){_(o,"class","svelte-1kxn0xq")},m(l,c){$(l,i,c),Wt(e,i,null),$(l,n,c),$(l,o,c),h(o,r),d=!0,I||(a=rt(o,"click",function(){Zt(t[1])&&t[1].apply(this,arguments)}),I=!0)},p(l,[c]){t=l;const y={};!g&&c&1&&(g=!0,y.canvas=t[0],jt(()=>g=!1)),e.$set(y)},i(l){d||(Ht(e.$$.fragment,l),d=!0)},o(l){Xt(e.$$.fragment,l),d=!1},d(l){l&&m(i),Yt(e),l&&m(n),l&&m(o),I=!1,a()}}}function ne(t,i,e){let g,n;function o(r){n=r,e(0,n)}return t.$$.update=()=>{t.$$.dirty&1&&e(1,g=()=>window.open(n.toDataURL("image/png").replace("image/png","image/octet-stream")))},[n,g,o]}class oe extends nt{constructor(i){super();it(this,i,ne,se,ot,{})}}export{oe as default};
